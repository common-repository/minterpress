"use strict";(self.webpackChunkminterpress=self.webpackChunkminterpress||[]).push([[446],{3649:(t,e,s)=>{s.d(e,{Z:()=>i});class i{static hiddenClass="hidden";static toggleButtons(t,e,s){t?(e.disabled=!0,s.disabled=!1):(s.disabled=!0,e.disabled=!1)}static show(t){t&&t.classList.remove(this.hiddenClass)}static hide(t){t&&t.classList.add(this.hiddenClass)}static toggleVisibility(t){t.classList.contains(this.hiddenClass)?this.show(t):this.hide(t)}static turnOnConfirmExit(){window.onbeforeunload=()=>!0}static turnOffConfirmExit(){window.onbeforeunload=null}}},8023:(t,e,s)=>{s.d(e,{Z:()=>n});var i=s(9669),a=s.n(i);class n{static getCredentials(){return{credentials:"include",headers:{"content-type":"application/json","X-WP-Nonce":wpApiSettings.nonce}}}static getPinataKeyEndpoint(){return`${wpApiSettings.root}minterpress/v1/pinata`}static getNftWpEndpoint(){return`${wpApiSettings.root}${wpApiSettings.versionString}minterpress_nfts`}static getGalleryWpEndpoint(){return`${wpApiSettings.root}${wpApiSettings.versionString}minterpress_gallery`}static async getPinataKeys(){const t=await a().get(this.getPinataKeyEndpoint(),this.getCredentials());return{pinataApiKey:t?.data?.api_key,pinataApiSecret:t?.data?.api_secret}}static async postToAjax(t,e=null){await jQuery.post(ajaxurl,t,(t=>(e&&(e.innerHTML=t),t)))}static prepareMetaData(t,e){return t.meta={},e.map((e=>{t.fieldName&&(t.meta[e]=t[e],delete t[e])})),t}static async saveNftDraft(t,e=null){const s=this.getCredentials(),i=new URLSearchParams(window.location.search),n=e??i.get("id"),r=t.entries(),o=Object.fromEntries(r),l=this.prepareMetaData(o,["mintQuantity","wpImageUrl","mintDescription"]);try{const t=(await a().post(`${this.getNftWpEndpoint()}/${n??""}`,l,s))?.data?.id;return t}catch(t){console.error("Error creating WP draft:",t)}}static async createGallery(t){const e=this.getCredentials(),s=t.entries(),i=Object.fromEntries(s),n=this.prepareMetaData(i,["tz_address"]);try{const t=(await a().post(this.getGalleryWpEndpoint(),n,e))?.data?.id;return await a().post(`${this.getGalleryWpEndpoint()}/${t}`,{status:"publish"},e),console.log(`Published WP Gallery with WP ID ${t}`),t}catch(t){console.error("Error creating WP draft:",t)}}static async updateGallery(t,e){return await a().post(`${this.getGalleryWpEndpoint()}/${t}`,e,this.getCredentials())}static async publishWpNft(t,e){if(console.log(e),!t||!e.opHash)return void console.error("Missing required paramenters.");const s=this.getCredentials();try{const i=await a().post(`${this.getNftWpEndpoint()}/${t}`,{status:"publish",meta:e},s);return console.log(`Published WP NFT with WP ID ${t} and op hash ${e.opHash}`),i}catch(t){console.error("Error publishing wp NFT:",t)}}}},446:(t,e,s)=>{s.r(e),s.d(e,{default:()=>n});var i=s(8023),a=s(3649);class n{constructor(t){this.el=t,this.init()}setVars(){this.nftId=this.el.dataset.nftStatusId,this.select=this.el.querySelector("select")}bindEvents(){this.select.addEventListener("change",(async t=>{a.Z.turnOnConfirmExit();const e="displayed"===t.target.value,s={action:"update_nft",id:this.nftId,meta:{public:e}};await i.Z.postToAjax(s),a.Z.turnOffConfirmExit()}))}init(){this.setVars(),this.bindEvents()}}}}]);