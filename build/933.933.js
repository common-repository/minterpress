(self.webpackChunkminterpress=self.webpackChunkminterpress||[]).push([[933],{3649:(t,e,i)=>{"use strict";i.d(e,{Z:()=>n});class n{static hiddenClass="hidden";static toggleButtons(t,e,i){t?(e.disabled=!0,i.disabled=!1):(i.disabled=!0,e.disabled=!1)}static show(t){t&&t.classList.remove(this.hiddenClass)}static hide(t){t&&t.classList.add(this.hiddenClass)}static toggleVisibility(t){t.classList.contains(this.hiddenClass)?this.show(t):this.hide(t)}static turnOnConfirmExit(){window.onbeforeunload=()=>!0}static turnOffConfirmExit(){window.onbeforeunload=null}}},8023:(t,e,i)=>{"use strict";i.d(e,{Z:()=>a});var n=i(9669),s=i.n(n);class a{static getCredentials(){return{credentials:"include",headers:{"content-type":"application/json","X-WP-Nonce":wpApiSettings.nonce}}}static getPinataKeyEndpoint(){return`${wpApiSettings.root}minterpress/v1/pinata`}static getNftWpEndpoint(){return`${wpApiSettings.root}${wpApiSettings.versionString}minterpress_nfts`}static getGalleryWpEndpoint(){return`${wpApiSettings.root}${wpApiSettings.versionString}minterpress_gallery`}static async getPinataKeys(){const t=await s().get(this.getPinataKeyEndpoint(),this.getCredentials());return{pinataApiKey:t?.data?.api_key,pinataApiSecret:t?.data?.api_secret}}static async postToAjax(t,e=null){await jQuery.post(ajaxurl,t,(t=>(e&&(e.innerHTML=t),t)))}static prepareMetaData(t,e){return t.meta={},e.map((e=>{t.fieldName&&(t.meta[e]=t[e],delete t[e])})),t}static async saveNftDraft(t,e=null){const i=this.getCredentials(),n=new URLSearchParams(window.location.search),a=e??n.get("id"),r=t.entries(),o=Object.fromEntries(r),l=this.prepareMetaData(o,["mintQuantity","wpImageUrl","mintDescription"]);try{const t=(await s().post(`${this.getNftWpEndpoint()}/${a??""}`,l,i))?.data?.id;return t}catch(t){console.error("Error creating WP draft:",t)}}static async createGallery(t){const e=this.getCredentials(),i=t.entries(),n=Object.fromEntries(i),a=this.prepareMetaData(n,["tz_address"]);try{const t=(await s().post(this.getGalleryWpEndpoint(),a,e))?.data?.id;return await s().post(`${this.getGalleryWpEndpoint()}/${t}`,{status:"publish"},e),console.log(`Published WP Gallery with WP ID ${t}`),t}catch(t){console.error("Error creating WP draft:",t)}}static async updateGallery(t,e){return await s().post(`${this.getGalleryWpEndpoint()}/${t}`,e,this.getCredentials())}static async publishWpNft(t,e){if(console.log(e),!t||!e.opHash)return void console.error("Missing required paramenters.");const i=this.getCredentials();try{const n=await s().post(`${this.getNftWpEndpoint()}/${t}`,{status:"publish",meta:e},i);return console.log(`Published WP NFT with WP ID ${t} and op hash ${e.opHash}`),n}catch(t){console.error("Error publishing wp NFT:",t)}}}},6933:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>o});var n=i(1907),s=i.n(n),a=i(8023),r=i(3649);class o{constructor(t){this.el=t,this.init()}enhanceTagInputs(){this.tagsEls.length>0&&this.tagsEls.forEach((t=>{s()(t)}))}async postDataToWpApi(t){const e=new FormData(this.el),i=await a.Z.saveNftDraft(e,this.wpId);this.wpId=i,r.Z.show(this.draftSavedNotice),t.preventDefault()}setVars(){this.tagsEls=this.el.querySelectorAll('input[type="tags"]'),this.draftButton=this.el.querySelector('[data-minting-form="draft-button"]'),this.draftSavedNotice=document.getElementById("minterpress-app-notice-saved"),this.wpId=null,this.wpMedia=wp.media.frames.file_frame=wp.media({title:"Select media",button:{text:"Select media"},multiple:!1}),this.uploadButton=this.el.querySelector("#upload-button"),this.uploadInput=this.uploadButton.querySelector("input"),this.preview=this.el.querySelector("#mint-image-preview"),this.dialogPreview=this.el.querySelector("#mint-image-dialog-preview"),this.hiddenWpImageUrl=this.el.querySelector("#wpImageUrl")}bindEvents(){this.draftButton.addEventListener("click",(t=>{this.postDataToWpApi(t,!0)})),this.uploadButton.addEventListener("click",(()=>{this.handleUpload()})),this.wpMedia.on("select",(()=>{var t=this.wpMedia.state().get("selection").first().toJSON();this.preview.style.backgroundImage="url('"+t.url+"')",this.hiddenWpImageUrl.value=t.url,this.dialogPreview.src=t.url,r.Z.hide(this.uploadInput)}))}handleUpload(){this.wpMedia&&this.wpMedia.open()}handleDraft(){this.hiddenWpImageUrl.value&&r.Z.hide(this.uploadInput)}init(){this.setVars(),this.bindEvents(),this.enhanceTagInputs(),this.handleDraft()}}},1907:function(t,e){var i,n;i=function(t,e){"use strict";e.exports=n;var i="placeholder pattern spellcheck autocomplete autocapitalize autofocus accessKey accept lang minLength maxLength required".split(" ");function n(t){function e(t,e,i,n){var s=document.createElement(t);for(var a in e&&(s.className=e),i&&(s.textContent=i),n)s.setAttribute("data-"+a,n[a]);return s}function n(t,e){return!0===e?Array.prototype.slice.call(c.querySelectorAll(t)):c.querySelector(t)}function s(){return n(".tag",!0).map((function(t){return t.textContent})).concat(c.input.value||[]).join(",")}function a(){t.value=s(),t.dispatchEvent(new Event("change"))}function r(i){if(~i.indexOf(",")&&(i=i.split(",")),Array.isArray(i))return i.forEach(r);var s=i&&i.trim();if(!s)return!1;if(!t.getAttribute("duplicates")){var a=function(){var t=n('[data-tag="'+s+'"]');if(t)return t.classList.add("dupe"),setTimeout((function(){return t.classList.remove("dupe")}),100),{v:!1}}();if("object"==typeof a)return a.v}c.insertBefore(e("span","tag",s,{tag:s}),c.input)}function o(t){var e=n(".selected");e&&e.classList.remove("selected"),t&&t.classList.add("selected")}function l(){var t=n(".tag",!0).pop(),e=c.offsetWidth;e&&(c.input.style.width=Math.max(e-(t?t.offsetLeft+t.offsetWidth:5)-5,e/4)+"px")}function p(t){"string"==typeof t||Array.isArray(t)||(t=c.input.value),!1!==r(t)&&(c.input.value="",a(),l())}function u(t){return t.target.classList.contains("tag")&&o(t.target),t.target===c.input?o():(c.input.focus(),t.preventDefault(),!1)}var c=e("div","tags-input"),d=t.nextSibling;t.parentNode[d?"insertBefore":"appendChild"](c,d),t.style.cssText="position:absolute;left:0;top:-99px;width:1px;height:1px;opacity:0.01;",t.tabIndex=-1,c.input=e("input"),c.input.setAttribute("type","text"),i.forEach((function(e){if(t[e]!==c.input[e]){c.input[e]=t[e];try{delete t[e]}catch(t){}}})),c.appendChild(c.input),t.addEventListener("focus",(function(){c.input.focus()})),c.input.addEventListener("focus",(function(){c.classList.add("focus"),o()})),c.input.addEventListener("blur",(function(){c.classList.remove("focus"),o(),p()})),c.input.addEventListener("keydown",(function(t){var e=c.input,i=t.keyCode||t.which,s=n(".tag.selected"),r=e.selectionStart===e.selectionEnd&&e.selectionStart,u=n(".tag",!0).pop();if(l(),13===i||188===i||9===i){if(!e.value&&188!==i)return;p()}else if(46===i&&s)s.nextSibling!==c.input&&o(s.nextSibling),c.removeChild(s),l(),a();else if(8===i)if(s)o(s.previousSibling),c.removeChild(s),l(),a();else{if(!u||0!==r)return;o(u)}else if(37===i)if(s)s.previousSibling&&o(s.previousSibling);else{if(0!==r)return;o(u)}else{if(39!==i)return o();if(!s)return;o(s.nextSibling)}return t.preventDefault(),!1})),c.input.addEventListener("input",(function(){t.value=s(),t.dispatchEvent(new Event("input"))})),c.input.addEventListener("paste",(function(){return setTimeout(p,0)})),c.addEventListener("mousedown",u),c.addEventListener("touchstart",u),c.setValue=function(t){n(".tag",!0).forEach((function(t){return c.removeChild(t)})),p(t)},c.getValue=s,p(t.value)}n.enhance=n.tagsInput=n},void 0===(n=i.apply(e,[e,t]))||(t.exports=n)}}]);