"use strict";(self.webpackChunkminterpress=self.webpackChunkminterpress||[]).push([[612],{8023:(t,e,a)=>{a.d(e,{Z:()=>n});var i=a(9669),s=a.n(i);class n{static getCredentials(){return{credentials:"include",headers:{"content-type":"application/json","X-WP-Nonce":wpApiSettings.nonce}}}static getPinataKeyEndpoint(){return`${wpApiSettings.root}minterpress/v1/pinata`}static getNftWpEndpoint(){return`${wpApiSettings.root}${wpApiSettings.versionString}minterpress_nfts`}static getGalleryWpEndpoint(){return`${wpApiSettings.root}${wpApiSettings.versionString}minterpress_gallery`}static async getPinataKeys(){const t=await s().get(this.getPinataKeyEndpoint(),this.getCredentials());return{pinataApiKey:t?.data?.api_key,pinataApiSecret:t?.data?.api_secret}}static async postToAjax(t,e=null){await jQuery.post(ajaxurl,t,(t=>(e&&(e.innerHTML=t),t)))}static prepareMetaData(t,e){return t.meta={},e.map((e=>{t.fieldName&&(t.meta[e]=t[e],delete t[e])})),t}static async saveNftDraft(t,e=null){const a=this.getCredentials(),i=new URLSearchParams(window.location.search),n=e??i.get("id"),r=t.entries(),o=Object.fromEntries(r),p=this.prepareMetaData(o,["mintQuantity","wpImageUrl","mintDescription"]);try{const t=(await s().post(`${this.getNftWpEndpoint()}/${n??""}`,p,a))?.data?.id;return t}catch(t){console.error("Error creating WP draft:",t)}}static async createGallery(t){const e=this.getCredentials(),a=t.entries(),i=Object.fromEntries(a),n=this.prepareMetaData(i,["tz_address"]);try{const t=(await s().post(this.getGalleryWpEndpoint(),n,e))?.data?.id;return await s().post(`${this.getGalleryWpEndpoint()}/${t}`,{status:"publish"},e),console.log(`Published WP Gallery with WP ID ${t}`),t}catch(t){console.error("Error creating WP draft:",t)}}static async updateGallery(t,e){return await s().post(`${this.getGalleryWpEndpoint()}/${t}`,e,this.getCredentials())}static async publishWpNft(t,e){if(console.log(e),!t||!e.opHash)return void console.error("Missing required paramenters.");const a=this.getCredentials();try{const i=await s().post(`${this.getNftWpEndpoint()}/${t}`,{status:"publish",meta:e},a);return console.log(`Published WP NFT with WP ID ${t} and op hash ${e.opHash}`),i}catch(t){console.error("Error publishing wp NFT:",t)}}}},4612:(t,e,a)=>{a.r(e),a.d(e,{default:()=>s});var i=a(8023);class s{constructor(t){this.el=t,this.init()}async handleCreate(t){t.preventDefault();const e=new FormData(this.el),a=await i.Z.createGallery(e);window.location.href=`${window.location.href}&id=${a}`}setVars(){}bindEvents(){this.el.addEventListener("submit",(t=>this.handleCreate(t)))}init(){this.setVars(),this.bindEvents()}}}}]);